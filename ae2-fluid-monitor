-- Funktion zur Formatierung der Flüssigkeitsmenge
function formatFluidAmount(amount)
    if amount >= 1e6 then
        return string.format("%.1f M", amount / 1e6)  -- Millionen
    elseif amount >= 1e3 then
        return string.format("%.1f K", amount / 1e3)  -- Tausend
    else
        return string.format("%.1f", amount)  -- Einzelne Einheiten
    end
end

-- Funktion zur Anzeige der Flüssigkeiten auf dem Monitor
function displayFluids()
    local monitor = peripheral.find("monitor")
    if not monitor then
        print("Kein Monitor gefunden.")
        return
    end

    monitor.setTextScale(1)
    monitor.clear()

    local bridge = peripheral.find("me_bridge")
    if not bridge then
        print("Keine ME Bridge gefunden.")
        return
    end

    local fluids, err = bridge.listFluids()
    if err then
        print("Fehler beim Abrufen der Flüssigkeiten: " .. err)
        return
    end

    local line = 1
    for _, fluid in ipairs(fluids) do
        local name = fluid.name or "Unbekannt"
        local amount = fluid.amount or 0
        local formattedAmount = formatFluidAmount(amount)
        local displayText = string.format("%s: %s", name, formattedAmount)
        monitor.setCursorPos(1, line)
        monitor.write(displayText)
        line = line + 1
    end
end

-- Hauptprogramm
displayFluids()
